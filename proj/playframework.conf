// https://github.com/playframework/playframework.git#2.9.x

// perhaps tracking main would work, but I'm inclined to be
// conservative and stick with 2.9.x for a while

vars.proj.playframework: ${vars.base} {
  name: "playframework"
  uri: "https://github.com/playframework/playframework.git#f03b3eb3183ce0bb12777b4d1f767003fcc07af7"

  extra.options: [
    // for JDK 17+
    "--add-exports=java.base/sun.security.x509=ALL-UNNAMED"
    // so older JDKs don't complain that `--add-exports` is unrecognized
    "-XX:+IgnoreUnrecognizedVMOptions"
  ]
  extra.exclude: [
    "Play-Docs", "Sbt-Plugin", "Play-Docs-Sbt-Plugin", "Sbt-Scripted-Tools"  // out of scope
    "Play-Integration-Test"  // TODO/WIP, see https://github.com/scala/community-builds/pull/819
    "Play-Microbenchmark" // out of scope (and besides, requires Play-Integration-Test)
    "Sbt-Routes-Compiler", "Play-Run-Support" // out of scope
  ]
  extra.commands: ${vars.default-commands} [
    // tests run forked, so this goes in javaOptions, not extra.options
    """set ThisBuild / javaOptions += "-Dakka.fail-mixed-versions=false""""
    // started failing consistently; maybe some site it depends on went down?
    // not investigated or reported
    """set PlayServerProject / Test / unmanagedSources / excludeFilter := HiddenFileFilter || "ServerSSLEngineSpec.scala""""
  ]
}
